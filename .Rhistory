knitr::kable(head(Robbery,5), format = "markdown", caption="The first 5 obs")
knitr::kable(tail(Robbery,5), format = "markdown", caption="The last 5 obs")
#Summary
#columns to analyse
cols <- c('Period_cat','Period_cat_2','Year', 'Month',
'Season','Date_cat','Date',
'SHIFT','Time_hour','Clearance_rate','Day_cat','Day_cat_2',
'METHOD','DISTRICT','PSA')
knitr::kable(summary(select(Robbery,cols)), format = "markdown", caption="Summary")
#Freq
#Robbery %>%
#  count(Clearance_rate)
#Where
#Robbery |>
#  filter(Clearance_rate > 1440)  # more that one-day
mean(Robbery$Month,na.rm = TRUE)
sd(Robbery$Month, na.rm = TRUE)
var(Robbery$Month, na.rm = TRUE)
mean(Robbery$Date,na.rm = TRUE)
sd(Robbery$Date, na.rm = TRUE)
var(Robbery$Date, na.rm = TRUE)
mean(Robbery$Day_cat,na.rm = TRUE)
sd(Robbery$Day_cat, na.rm = TRUE)
var(Robbery$Day_cat, na.rm = TRUE)
mean(Robbery$Time_hour,na.rm = TRUE)
sd(Robbery$Time_hour, na.rm = TRUE)
var(Robbery$Time_hour, na.rm = TRUE)
# 12~18: 1114, 18~23:1937, 0~7: 3726,7~12: 1568
#Robbery |>
#  filter(Time_hour>=0,Time_hour<7)
mean(Robbery$Clearance_rate,na.rm = TRUE)
sd(Robbery$Clearance_rate, na.rm = TRUE)
var(Robbery$Clearance_rate, na.rm = TRUE)
# more that 2 hours: 2,599
#Robbery |>
#  filter(Clearance_rate > 120)
mean(Robbery$DISTRICT,na.rm = TRUE)
sd(Robbery$DISTRICT, na.rm = TRUE)
var(Robbery$DISTRICT, na.rm = TRUE)
#Time_hour Clearance_rate PSA
mean(Robbery$PSA,na.rm = TRUE)
sd(Robbery$PSA, na.rm = TRUE)
var(Robbery$PSA, na.rm = TRUE)
# Bar plot 1.: Freq by yeqr (x:discrete, Barchart)+Value=count(freq)
plot_year <- ggplot(data=Robbery, aes(x=Year)) +
geom_bar(colour="darkgrey", fill="lightgrey",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) +
labs(x="Year") + labs(title="C1.Yearly Robbery frequency")
# Bar plot 2.: Freq by Month (x:continuous, Histogram)+Value=count(freq)
plot_Month <- ggplot(data=Robbery, aes(Month)) +
geom_histogram(col="darkgrey",
fill="lightgrey",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2.Monthly Robbery frequency") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
# Bar plot 3.: Freq by Period phase(Pre,lockdown,post)+Value=count(freq)
plot_Period <- ggplot(data=Robbery, aes(x=Period_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..), vjust = 1.5) +
labs(x="Period") + labs(title="C3.Robbery by Pandemic phase")
###################################
# Barplot 4. average Robbery frequency per month [by Period_cat]+Value
temp <- count(Robbery,Period_cat, sort=TRUE)
#Avg
temp[1,3] = as.integer(temp[1,2] / 16.84 ) #post: 16M+26d
temp[2,3] = as.integer(temp[2,2] / 16.42) #pre: 16M+13d
temp[3,3] = as.integer(temp[3,2] / 14.39) #pre: 14M+12d
#bar plot
x <-  c("Pre","Lock","Post")
y  <-  c(178, 161, 185 )
temp_2 <- data.frame(x,y)
#barplot(y, names.arg = x)
plot_Period_mon <- ggplot(data=temp_2, aes(x,y)) +
geom_bar(col="darkblue",
fill="lightblue",
alpha = .7,stat='identity') +
labs(x="Period", y="Avg.Robbery") +
labs(title="C5.Avg.Robbery(per month)") + scale_x_discrete(limits=c("Pre","Lock","Post")) + geom_text(aes(label=signif(y)),vjust = 1.5)
grid.arrange(plot_year, plot_Month, plot_Period, plot_Period_mon, ncol=2, nrow=2)
#1. by pandemic phrases
Robbery_pre <- subset(Robbery,subset = Robbery$Period_cat == 'Pre')  #2574
Robbery_lock <- subset(Robbery,subset = Robbery$Period_cat == 'Lock') #2648
Robbery_post <- subset(Robbery,subset = Robbery$Period_cat == 'Post') #3123
#2. by year
Robbery_2019 <- subset(Robbery,subset = Robbery$Year == 2019)  #2574
Robbery_2020 <- subset(Robbery,subset = Robbery$Year == 2020) #2648
Robbery_2021 <- subset(Robbery,subset = Robbery$Year == 2021)
Robbery_2022 <- subset(Robbery,subset = Robbery$Year == 2022)
# Bar plot 2.: Freq by Month :split by pandemic phrase
plot_Month <- ggplot(data=Robbery, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2.Monthly Robbery frequency") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_pre <- ggplot(data=Robbery_pre, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_1.Monthly Robbery (Pre)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_lock <- ggplot(data=Robbery_lock, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_2.Monthly Robbery (Lock)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_post <- ggplot(data=Robbery_post, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_3.Monthly Robbery (Post)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
grid.arrange(plot_Month, plot_Month_pre,plot_Month_lock, plot_Month_post, ncol=2, nrow=2)
#nammin revise: add library options
library(ezids)
library(readr) #install & load
library(ggplot2)
library(DBI) #SQL
library(magrittr)
library(dplyr)  #for data manipulation.
library(tidyr) #for data tidying.
library(tidyverse)
library(graphics)
library(gridExtra) #graph arrange(positioning)
#nammin revise: knitr::opts_chunk$set(echo = TRUE) > combined as following
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
options(scientific=T, digits = 3)
#Import
Robbery = data.frame(read.csv("Robbery_DC_clean.csv"))
#create Clearance_rate(Unit: Minute)= END_DATE - START_DATE
#1. 'Date' format
Robbery$START_DATE_2 <- as.POSIXct(Robbery$START_DATE,format = "%Y/%m/%d %H:%M:%S")
Robbery$END_DATE_2 <- as.POSIXct(Robbery$END_DATE,format = "%Y/%m/%d %H:%M:%S")
Robbery$Clearance_rate <- as.numeric(difftime(strptime(Robbery$END_DATE_2,"%Y-%m-%d%H:%M:%S"),strptime(Robbery$START_DATE_2,"%Y-%m-%d %H:%M:%S")))/60
Robbery$Clearance_rate <- format(round(Robbery$Clearance_rate, 0), nsmall = 0)
Robbery$Clearance_rate<- as.integer(Robbery$Clearance_rate)
#head(select(Robbery,START_DATE, START_DATE_2, END_DATE_2,Clearance_rate),5)
#strptime(paste(Robbery$START_DATE, Robbery$END_DATE), "%Y-%m-%d")  #%H:%M
#column remove
Robbery <- select(Robbery,-Robbery_Time, -START_DATE, -END_DATE)
#as.numeric(difftime(strptime(END_DATE_2,"%Y-%m-%d%H:%M:%S"),strptime(START_DATE_2,"%Y-%m-%d %H:%M:%S")))
#rename
Robbery <-rename(Robbery, START_DATE = START_DATE_2)
Robbery <-rename(Robbery, END_DATE = END_DATE_2)
# change datatypes of Char.var for EDA (as Factor)
cols <- c('Period_cat','Period_cat_2','Season','Date_cat','Day_cat_2','SHIFT','METHOD')
Robbery %<>%
mutate_each_(funs(factor(.)),cols)
#Category var. label order fix
Robbery$Period_cat <- factor(Robbery$Period_cat, levels=c("Pre", "Lock", "Post"))
#Robbery$SHIFT<- as.factor(Robbery$SHIFT)
str(Robbery)
#colnames(Robbery)
#ncol(Robbery)
#nrow(Robbery)
knitr::kable(head(Robbery,5), format = "markdown", caption="The first 5 obs")
knitr::kable(tail(Robbery,5), format = "markdown", caption="The last 5 obs")
#Summary
#columns to analyse
cols <- c('Period_cat','Period_cat_2','Year', 'Month',
'Season','Date_cat','Date',
'SHIFT','Time_hour','Clearance_rate','Day_cat','Day_cat_2',
'METHOD','DISTRICT','PSA')
knitr::kable(summary(select(Robbery,cols)), format = "markdown", caption="Summary")
#Freq
#Robbery %>%
#  count(Clearance_rate)
#Where
#Robbery |>
#  filter(Clearance_rate > 1440)  # more that one-day
mean(Robbery$Month,na.rm = TRUE)
sd(Robbery$Month, na.rm = TRUE)
var(Robbery$Month, na.rm = TRUE)
mean(Robbery$Date,na.rm = TRUE)
sd(Robbery$Date, na.rm = TRUE)
var(Robbery$Date, na.rm = TRUE)
mean(Robbery$Day_cat,na.rm = TRUE)
sd(Robbery$Day_cat, na.rm = TRUE)
var(Robbery$Day_cat, na.rm = TRUE)
mean(Robbery$Time_hour,na.rm = TRUE)
sd(Robbery$Time_hour, na.rm = TRUE)
var(Robbery$Time_hour, na.rm = TRUE)
# 12~18: 1114, 18~23:1937, 0~7: 3726,7~12: 1568
#Robbery |>
#  filter(Time_hour>=0,Time_hour<7)
mean(Robbery$Clearance_rate,na.rm = TRUE)
sd(Robbery$Clearance_rate, na.rm = TRUE)
var(Robbery$Clearance_rate, na.rm = TRUE)
# more that 2 hours: 2,599
#Robbery |>
#  filter(Clearance_rate > 120)
mean(Robbery$DISTRICT,na.rm = TRUE)
sd(Robbery$DISTRICT, na.rm = TRUE)
var(Robbery$DISTRICT, na.rm = TRUE)
#Time_hour Clearance_rate PSA
mean(Robbery$PSA,na.rm = TRUE)
sd(Robbery$PSA, na.rm = TRUE)
var(Robbery$PSA, na.rm = TRUE)
# Bar plot 1.: Freq by yeqr (x:discrete, Barchart)+Value=count(freq)
plot_year <- ggplot(data=Robbery, aes(x=Year)) +
geom_bar(colour="darkgrey", fill="lightgrey",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) +
labs(x="Year") + labs(title="C1.Yearly Robbery frequency")
# Bar plot 2.: Freq by Month (x:continuous, Histogram)+Value=count(freq)
plot_Month <- ggplot(data=Robbery, aes(Month)) +
geom_histogram(col="darkgrey",
fill="lightgrey",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2.Monthly Robbery frequency") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
# Bar plot 3.: Freq by Period phase(Pre,lockdown,post)+Value=count(freq)
plot_Period <- ggplot(data=Robbery, aes(x=Period_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..), vjust = 1.5) +
labs(x="Period") + labs(title="C3.Robbery by Pandemic phase")
###################################
# Barplot 4. average Robbery frequency per month [by Period_cat]+Value
temp <- count(Robbery,Period_cat, sort=TRUE)
#Avg
temp[1,3] = as.integer(temp[1,2] / 16.84 ) #post: 16M+26d
temp[2,3] = as.integer(temp[2,2] / 16.42) #pre: 16M+13d
temp[3,3] = as.integer(temp[3,2] / 14.39) #pre: 14M+12d
#bar plot
x <-  c("Pre","Lock","Post")
y  <-  c(178, 161, 185 )
temp_2 <- data.frame(x,y)
#barplot(y, names.arg = x)
plot_Period_mon <- ggplot(data=temp_2, aes(x,y)) +
geom_bar(col="darkblue",
fill="lightblue",
alpha = .7,stat='identity') +
labs(x="Period", y="Avg.Robbery") +
labs(title="C5.Avg.Robbery(per month)") + scale_x_discrete(limits=c("Pre","Lock","Post")) + geom_text(aes(label=signif(y)),vjust = 1.5)
grid.arrange(plot_year, plot_Month, plot_Period, plot_Period_mon, ncol=2, nrow=2)
#1. by pandemic phrases
Robbery_pre <- subset(Robbery,subset = Robbery$Period_cat == 'Pre')  #2574
Robbery_lock <- subset(Robbery,subset = Robbery$Period_cat == 'Lock') #2648
Robbery_post <- subset(Robbery,subset = Robbery$Period_cat == 'Post') #3123
#2. by year
Robbery_2019 <- subset(Robbery,subset = Robbery$Year == 2019)  #2574
Robbery_2020 <- subset(Robbery,subset = Robbery$Year == 2020) #2648
Robbery_2021 <- subset(Robbery,subset = Robbery$Year == 2021)
Robbery_2022 <- subset(Robbery,subset = Robbery$Year == 2022)
# Bar plot 2.: Freq by Month :split by pandemic phrase
plot_Month <- ggplot(data=Robbery, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2.Monthly Robbery frequency") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_pre <- ggplot(data=Robbery_pre, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_1.Monthly Robbery (Pre)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_lock <- ggplot(data=Robbery_lock, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_2.Monthly Robbery (Lock)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_post <- ggplot(data=Robbery_post, aes(Month)) +
geom_histogram(col="darkblue",
fill="lightblue",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_3.Monthly Robbery (Post)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
grid.arrange(plot_Month, plot_Month_pre,plot_Month_lock, plot_Month_post, ncol=2, nrow=2)
# Bar plot 2.: Freq by Month :split by pandemic phrase
plot_Month_2019 <- ggplot(data=Robbery_2019, aes(Month)) +
geom_histogram(col="darkgrey",
fill="lightgrey",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_4.Monthly Robbery(2019)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_2020 <- ggplot(data=Robbery_2020, aes(Month)) +
geom_histogram(col="darkgrey",
fill="lightgrey",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_5.Monthly Robbery(2020)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_2021 <- ggplot(data=Robbery_2021, aes(Month)) +
geom_histogram(col="darkgrey",
fill="lightgrey",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_6.Monthly Robbery(2021)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
plot_Month_2022 <- ggplot(data=Robbery_2022, aes(Month)) +
geom_histogram(col="darkgrey",
fill="lightgrey",
alpha = .7) +
labs(x="Month", y="Frequency") +
labs(title="C2_7.Monthly Robbery(2022)") + scale_x_continuous(breaks=1:12) + geom_text(stat='count', aes(label=..count..),vjust = 1.5)
grid.arrange(plot_Month_2019, plot_Month_2020,plot_Month_2021, plot_Month_2022, ncol=2, nrow=2)
plot_Season <- ggplot(data=Robbery, aes(x=Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C3.Seansonally Robbery frequency")
plot_Season_pre <- ggplot(data=Robbery_pre, aes(Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C3_1.Seasonly Robbery (Pre)")
plot_Season_lock <- ggplot(data=Robbery_lock, aes(Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C3_2.Seasonly Robbery (Lock)")
plot_Season_post <- ggplot(data=Robbery_post, aes(Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C3_3.Seasonly Robbery (Post)")
grid.arrange(plot_Season, plot_Season_pre, plot_Season_lock, plot_Season_post,
ncol=2, nrow=2)
plot_Season_2019 <- ggplot(data=Robbery_2019, aes(x=Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C4_1.Seansonally Robbery (2019)")
plot_Season_2020 <- ggplot(data=Robbery_2020, aes(x=Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C4_2.Seansonally Robbery (2020)")
plot_Season_2021 <- ggplot(data=Robbery_2021, aes(x=Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C4_3.Seansonally Robbery (2021)")
plot_Season_2022 <- ggplot(data=Robbery_2022, aes(x=Season)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("SPRING","SUMMER","AUTUMN","WINTER")) +
labs(x="Season") + labs(title="C4_4.Seansonally Robbery (2022)")
grid.arrange(plot_Season_2019, plot_Season_2020, plot_Season_2021, plot_Season_2022,
ncol=2, nrow=2)
# Bar plot
plot_Date_cat <- ggplot(data=Robbery, aes(x=Date_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Begin","Middle","End")) +
labs(x="Date_cat") + labs(title="C5.Incident Date of Robbery")
plot_Date_cat_pre <- ggplot(data=Robbery_pre, aes(Date_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Begin","Middle","End")) +
labs(x="Date_cat") + labs(title="C5_1.Incident Date (Pre)")
plot_Date_cat_lock <- ggplot(data=Robbery_lock, aes(Date_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Begin","Middle","End")) +
labs(x="Date_cat") + labs(title="C5_2.Incident Date (Lock)")
plot_Date_cat_post <- ggplot(data=Robbery_post, aes(Date_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Begin","Middle","End")) +
labs(x="Date_cat") + labs(title="C5_3.Incident Date (Post)")
grid.arrange(plot_Date_cat, plot_Date_cat_pre, plot_Date_cat_lock, plot_Date_cat_post,
ncol=2, nrow=2)
boxplot_Date <- ggplot(Robbery, aes(y=Date, x=Period_cat, fill=Period_cat)) +
geom_boxplot() +
geom_boxplot( colour=c("#ff0000","#11cc11","#0000ff"), outlier.shape=8,
outlier.colour="lightblue", outlier.size=4) +  labs(title="C5_4.Box_Date of Robbery", x="Period", y = "Robbery date") + ylim(0,32)
boxplot_Date
# Bar plot
plot_SHIFT <- ggplot(data=Robbery, aes(x=SHIFT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("DAY","EVENING","MIDNIGHT")) +
labs(x="Timezone") + labs(title="C6.Incident timezone of Robbery")
plot_SHIFT_pre <- ggplot(data=Robbery_pre, aes(SHIFT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("DAY","EVENING","MIDNIGHT")) +
labs(x="Timezone") + labs(title="C6_1.Incident timezone (Pre)")
plot_SHIFT_lock <- ggplot(data=Robbery_lock, aes(SHIFT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("DAY","EVENING","MIDNIGHT")) +
labs(x="Timezone") + labs(title="C6_2.Incident timezone (Lock)")
plot_SHIFT_post <- ggplot(data=Robbery_post, aes(SHIFT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("DAY","EVENING","MIDNIGHT")) +
labs(x="Timezone") + labs(title="C6_3.Incident timezone (Post)")
grid.arrange(plot_SHIFT, plot_SHIFT_pre, plot_SHIFT_lock, plot_SHIFT_post,
ncol=2, nrow=2)
boxplot_Time_hour <- ggplot(Robbery, aes(y=Time_hour, x=Period_cat, fill=Period_cat)) +
geom_boxplot() +
geom_boxplot( colour=c("#ff0000","#11cc11","#0000ff"), outlier.shape=8,
outlier.colour="lightblue", outlier.size=4) +  labs(title="C6_4.Box_Time_hour of Robbery", x="Period", y = "Robbery Time_hour") + ylim(0,23)
boxplot_Time_hour
# Bar plot
plot_Day_cat<- ggplot(data=Robbery, aes(x=Day_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Sun","Mon","Tue","Wed","Thur","Fri","Sat")) +
labs(x="Day") + labs(title="C7.Incident Date of Robbery")
plot_Day_cat_pre <- ggplot(data=Robbery_pre, aes(Day_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Mon","Tue","Wed","Thur","Fri","Sat","Sun")) +
labs(x="Day") + labs(title="C7_1.Incident Date (Pre)")
plot_Day_cat_lock <- ggplot(data=Robbery_lock, aes(Day_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Mon","Tue","Wed","Thur","Fri","Sat","Sun")) +
labs(x="Day") + labs(title="C7_2.Incident Date (Lock)")
plot_Day_cat_post <- ggplot(data=Robbery_post, aes(Day_cat)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + scale_x_discrete(limits=c("Mon","Tue","Wed","Thur","Fri","Sat","Sun")) +
labs(x="Day") + labs(title="C7_3.Incident Date (Post)")
grid.arrange(plot_Day_cat, plot_Day_cat_pre, plot_Day_cat_lock, plot_Day_cat_post,
ncol=2, nrow=2)
# Bar plot
plot_Day_cat_2<- ggplot(data=Robbery, aes(x=Day_cat_2)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="Day") +
labs(title="C8.Incident Date_2 of Robbery")
plot_Day_cat_2_pre <- ggplot(data=Robbery_pre, aes(Day_cat_2)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) +labs(x="Day") +
labs(title="C8_1.Incident Date_2 (Pre)")
plot_Day_cat_2_lock <- ggplot(data=Robbery_lock, aes(Day_cat_2)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="Day") +
labs(title="C8_2.Incident Date_2 (Lock)")
plot_Day_cat_2_post <- ggplot(data=Robbery_post, aes(Day_cat_2)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="Day") +
labs(title="C8_3.Incident Date_2 (Post)")
grid.arrange(plot_Day_cat_2, plot_Day_cat_2_pre, plot_Day_cat_2_lock, plot_Day_cat_2_post,
ncol=2, nrow=2)
# Bar plot
plot_METHOD<- ggplot(data=Robbery, aes(x=METHOD)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="METHOD") +
labs(title="c9.Incident Date_2 of Robbery")
plot_METHOD_pre <- ggplot(data=Robbery_pre, aes(METHOD)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) +labs(x="METHOD") +
labs(title="c9_1.Incident Date_2 (Pre)")
plot_METHOD_lock <- ggplot(data=Robbery_lock, aes(METHOD)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="METHOD") +
labs(title="c9_2.Incident Date_2 (Lock)")
plot_METHOD_post <- ggplot(data=Robbery_post, aes(METHOD)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="METHOD") +
labs(title="c9_3.Incident Date_2 (Post)")
grid.arrange(plot_METHOD, plot_METHOD_pre, plot_METHOD_lock, plot_METHOD_post,
ncol=2, nrow=2)
# Bar plot
plot_DISTRICT<- ggplot(data=Robbery, aes(x=DISTRICT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="DISTRICT") + scale_x_discrete(limits=c("1","2","3","4","5","6","NA")) +
labs(title="c10.DISTRICT of Robbery")
plot_DISTRICT_pre<- ggplot(data=Robbery_pre, aes(x=DISTRICT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="DISTRICT") + scale_x_discrete(limits=c("1","2","3","4","5","6","NA")) +
labs(title="c10_1.DISTRICT (Pre)")
plot_DISTRICT_lock<- ggplot(data=Robbery_lock, aes(x=DISTRICT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="DISTRICT") + scale_x_discrete(limits=c("1","2","3","4","5","6","NA")) +
labs(title="c10_2.DISTRICT (Lock)")
plot_DISTRICT_post<- ggplot(data=Robbery_post, aes(x=DISTRICT)) +
geom_bar(colour="darkblue", fill="lightblue",alpha = .7) +
geom_text(stat='count', aes(label=..count..),vjust = 1.5) + labs(x="DISTRICT") + scale_x_discrete(limits=c("1","2","3","4","5","6","NA")) +
labs(title="c10_3.DISTRICT (Post)")
grid.arrange(plot_DISTRICT, plot_DISTRICT_pre, plot_DISTRICT_lock, plot_DISTRICT_post,ncol=2, nrow=2)
boxplot_PSA <- ggplot(Robbery, aes(y=PSA, x=Period_cat, fill=Period_cat)) +
geom_boxplot() +
geom_boxplot( colour=c("#ff0000","#11cc11","#0000ff"), outlier.shape=8,
outlier.colour="lightblue", outlier.size=4) +  labs(title="Location(PSA) of Robbery", x="Period", y = "c11_Box_Robbery Location(PSA)")
boxplot_PSA
boxplot_Clearance <- ggplot(Robbery, aes(y=Clearance_rate, x=Period_cat, fill=Period_cat)) +
geom_boxplot() +
geom_boxplot( colour=c("#ff0000","#11cc11","#0000ff"), outlier.shape=8,
outlier.colour="lightblue", outlier.size=4) +  labs(title="Box_Clearance rate of Robbery", x="Period", y = "Clearance_rate(Minute)")
boxplot_Clearance
#Initial work
#ggplot(data=Robbery, aes(Year)) +
#  geom_histogram(col="red",
#                 fill="blue",
#                 alpha = .7) +
#  labs(x="Year", y="Frequency") +
#  labs(title="Yearly crime frequency")
#ggplot(data=Robbery, aes(Day_cat)) +
#  geom_histogram(col="red",
#                 fill="blue",
#                 alpha = .7) +
#  labs(x="Day_cat", y="Frequency") +
#  labs(title="Dayily crime frequency")
#ggplot(data=Robbery, aes(DISTRICT)) +
#  geom_histogram(col="red",
#                 fill="blue",
#                 alpha = .7) +
#  labs(x="DISTRICT", y="Frequency") +
#  labs(title="Crime frequency in different Districts")
#Save current data
#readr::write_rds(Robbery, "Robbery_230226.Rds")
#readr::write_rds(Robbery_pre, "Robbery_pre_230226.Rds")
#readr::write_rds(Robbery_lock, "Robbery_lock_230226.Rds")
#readr::write_rds(Robbery_post, "Robbery_post_230226.Rds")
#Use this code to load
Robbery <-
readr::read_rds("Robbery_230226.Rds")
#Initial work
#ggplot(data=Robbery, aes(Year)) +
#  geom_histogram(col="red",
#                 fill="blue",
#                 alpha = .7) +
#  labs(x="Year", y="Frequency") +
#  labs(title="Yearly crime frequency")
#ggplot(data=Robbery, aes(Day_cat)) +
#  geom_histogram(col="red",
#                 fill="blue",
#                 alpha = .7) +
#  labs(x="Day_cat", y="Frequency") +
#  labs(title="Dayily crime frequency")
#ggplot(data=Robbery, aes(DISTRICT)) +
#  geom_histogram(col="red",
#                 fill="blue",
#                 alpha = .7) +
#  labs(x="DISTRICT", y="Frequency") +
#  labs(title="Crime frequency in different Districts")
#str(Robbery)
